---
title: 计算某天是当月第几周
tags:
  - actionscript
  - flash
  - vbs
id: 886
categories:
  - Flash
abbrlink: 8c91055b
date: 2006-04-28 17:20:53
---

在网上看到这样文章，是用VBS写的，觉得有些麻烦，于是想自己写一个，才发现VBS本来就有类似的函数，于是很容易得实现了

<table width="100%" cellspacing="2" cellpadding="5" bgcolor="#f7f7f7" code="" class="TBBG9">    <tbody>        <tr>            <td bgcolor="#eeeeee" class="TBBG1">Function&nbsp;weekOfMonth(myDate)

            &nbsp;&nbsp; monthWeek&nbsp;=&nbsp;DatePart(&quot;ww&quot;,DateAdd(&quot;d&quot;,-day(myDate)+1,myDate)) ''取得该月1号是本年第几周

            &nbsp;&nbsp; dayWeek&nbsp;=&nbsp;DatePart(&quot;ww&quot;,myDate) ''取得该日期是本年第几周

            &nbsp;&nbsp; weekOfMonth&nbsp;=&nbsp;dayWeek&nbsp;-&nbsp;monthWeek&nbsp;+&nbsp;1

            End&nbsp;Function</td>        </tr>    </tbody></table>

返回是整数，可以这样调用：

<table width="100%" cellspacing="2" cellpadding="5" bgcolor="#f7f7f7" code="" class="TBBG9">    <tbody>        <tr>            <td bgcolor="#eeeeee" class="TBBG1">MsgBox&nbsp;weekOfMonth(&quot;2006-8-20&quot;)</td>        </tr>    </tbody></table>

写完觉得太简单了，再用Flash写一个，在Flash里面找不到关于周计算的函数，只能自己写算法了

<table width="100%" cellspacing="2" cellpadding="5" bgcolor="#f7f7f7" code="" class="TBBG9">    <tbody>        <tr>            <td bgcolor="#eeeeee" class="TBBG1">            <pre><font color="#993300">function</font> weekOfMonth(yyyy:<font color="#993300">Number</font>,mm:<font color="#993300">Number</font>,dd:<font color="#993300">Number</font>):<font color="#993300">Number</font>{
        <font color="#993300">var</font> myDate = <font color="#993300">new</font> <font color="#993300">Date</font> (yyyy, mm-1, dd);
        <font color="#993300">var</font> diff = myDate.<font color="#000087">getDate</font>() - 1;
        myDate.<font color="#000087">setDate</font>(1);
        <font color="#993300">var</font> dateWeek = 6 - myDate.<font color="#000087">getDay</font> ();
        <font color="#993300">if</font> (diff &gt; dateWeek){
                diff -= dateWeek;
                <font color="#993300">var</font> dateMod = diff % 7;
                <font color="#993300">if</font>(dateMod &gt; 0){
                        <font color="#993300">return</font> (diff - dateMod)/7 + 2;
                }<font color="#993300">else</font>{
                        <font color="#993300">return</font> diff/7 + 1;
                }
        }<font color="#993300">else</font>{
                <font color="#993300">return</font> 1;
        }
}
</pre>            </td>        </tr>    </tbody></table>

也是返回整型，调用方法

<table width="100%" cellspacing="2" cellpadding="5" bgcolor="#f7f7f7" code="" class="TBBG9">    <tbody>        <tr>            <td bgcolor="#eeeeee" class="TBBG1">trace(weekOfMonth(2006,8,20));</td>        </tr>    </tbody></table>

函数也很简单，就不多说了。下面是Flash演示，![](/images/2006/04/28_12759.gif)[这里下载源文件(133KB)](/blog/upload/2006/04/28/171742.rar)，Flash8

[](/blog/upload/2006/04/28/171610.swf "点击这里使 Adblock Plus 过滤该对象")[](/blog/upload/2006/04/28/171610.swf "点击这里使 Adblock Plus 过滤该对象")<object width="350" height="150" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=4,0,2,0">
<param value="9260" name="_cx" /><param value="3969" name="_cy" /><param value="" name="FlashVars" /><param value="/blog/upload/2006/04/28/171610.swf" name="Movie" /><param value="/blog/upload/2006/04/28/171610.swf" name="Src" /><param value="Window" name="WMode" /><param value="0" name="Play" /><param value="-1" name="Loop" /><param value="High" name="Quality" /><param value="" name="SAlign" /><param value="-1" name="Menu" /><param value="" name="Base" /><param value="" name="AllowScriptAccess" /><param value="ShowAll" name="Scale" /><param value="0" name="DeviceFont" /><param value="0" name="EmbedMovie" /><param value="" name="BGColor" /><param value="" name="SWRemote" /><param value="" name="MovieData" /><param value="1" name="SeamlessTabbing" /><param value="0" name="Profile" /><param value="" name="ProfileAddress" /><param value="0" name="ProfilePort" /> <embed width="350" height="150" x-shockwave-flash="" application="" type="" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" quality="high" src="/blog/upload/2006/04/28/171610.swf"></embed></object>

前面说到的文章在[这里](http://www.mikecat.net/blogview.asp?logID=1527)，有兴趣可以看看