---
title: 计算某天是当月第几周
tags:
  - actionscript
  - Flash
  - vbs
id: 886
categories:
  - Flash
abbrlink: 8c91055b
date: 2006-04-28 17:20:53
---

在网上看到这样文章，是用VBS写的，觉得有些麻烦，于是想自己写一个，才发现VBS本来就有类似的函数，于是很容易得实现了

```vbs
Function weekOfMonth(myDate)
   monthWeek = DatePart("ww",DateAdd("d",-day(myDate)+1,myDate)) '取得该月1号是本年第几周
   dayWeek = DatePart("ww",myDate) '取得该日期是本年第几周
   weekOfMonth = dayWeek - monthWeek + 1
End Function
```

返回是整数，可以这样调用：
```vbs
MsgBox weekOfMonth("2006-8-20")
```

写完觉得太简单了，再用Flash写一个，在Flash里面找不到关于周计算的函数，只能自己写算法了
<!--more-->
```as
function weekOfMonth(yyyy:Number,mm:Number,dd:Number):Number{
        var myDate = new Date (yyyy, mm-1, dd);
        var diff = myDate.getDate() - 1;
        myDate.setDate(1);
        var dateWeek = 6 - myDate.getDay ();
        if (diff > dateWeek){
                diff -= dateWeek;
                var dateMod = diff % 7;
                if(dateMod > 0){
                        return (diff - dateMod)/7 + 2;
                }else{
                        return diff/7 + 1;
                }
        }else{
                return 1;
        }
}
```

也是返回整型，调用方法
```as
trace(weekOfMonth(2006,8,20));
```

函数也很简单，就不多说了。下面是Flash演示
~~[这里下载源文件(133KB)](/upload/2006/04/28/171742.rar)~~，Flash8

<object width="350" height="150" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=4,0,2,0">
<param value="9260" name="_cx" /><param value="3969" name="_cy" /><param value="" name="FlashVars" /><param value="/images/2006/04/28/171610.swf" name="Movie" /><param value="/images/2006/04/28/171610.swf" name="Src" /><param value="Window" name="WMode" /><param value="0" name="Play" /><param value="-1" name="Loop" /><param value="High" name="Quality" /><param value="" name="SAlign" /><param value="-1" name="Menu" /><param value="" name="Base" /><param value="" name="AllowScriptAccess" /><param value="ShowAll" name="Scale" /><param value="0" name="DeviceFont" /><param value="0" name="EmbedMovie" /><param value="" name="BGColor" /><param value="" name="SWRemote" /><param value="" name="MovieData" /><param value="1" name="SeamlessTabbing" /><param value="0" name="Profile" /><param value="" name="ProfileAddress" /><param value="0" name="ProfilePort" /> <embed width="350" height="150" x-shockwave-flash="" application="" type="" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" quality="high" src="/images/2006/04/28/171610.swf"></embed></object>

前面说到的文章在[这里](http://www.mikecat.net/blogview.asp?logID=1527)，有兴趣可以看看